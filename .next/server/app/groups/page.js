(()=>{var e={};e.id=2586,e.ids=[2586],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},74351:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(85958),r(95499),r(72110),r(35866);var s=r(23191),a=r(88716),l=r(37922),n=r.n(l),o=r(95231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);r.d(t,i);let d=["",{children:["groups",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,85958)),"C:\\vyaparconnect-crm\\src\\app\\groups\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,95499)),"C:\\vyaparconnect-crm\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,72110)),"C:\\vyaparconnect-crm\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\vyaparconnect-crm\\src\\app\\groups\\page.tsx"],p="/groups/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/groups/page",pathname:"/groups",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},57299:(e,t,r)=>{Promise.resolve().then(r.bind(r,91241))},63062:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(62881).Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},83855:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(62881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},91241:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(10326),a=r(17577),l=r(83855),n=r(24061),o=r(69508),i=r(98091);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,r(62881).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var c=r(79375),p=r(28676),u=r(63062),x=r(77506);let g=({group:e,isOpen:t,onClose:r,onSuccess:l})=>{let[n,o]=(0,a.useState)(""),[i,d]=(0,a.useState)(""),[c,g]=(0,a.useState)(!1),[m,h]=(0,a.useState)("");(0,a.useEffect)(()=>{t&&(e?(o(e.name),d(e.whatsappGroupId)):(o(""),d("")),h(""))},[e,t]);let y=async t=>{t.preventDefault(),g(!0),h("");try{let t=e?`/api/groups/${e.id}`:"/api/groups",r=e?{name:n}:{name:n,whatsappGroupId:i},s=await fetch(t,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to save group.");l()}catch(e){h(e.message)}finally{g(!1)}};return s.jsx(p.Z,{isOpen:t,onClose:r,title:e?"Edit Group":"Register New Group",children:(0,s.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[m&&s.jsx("p",{className:"text-red-600 bg-red-50 dark:bg-red-900/20 p-2 rounded-md text-sm",children:m}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"group-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Group Display Name"}),s.jsx("input",{id:"group-name",type:"text",value:n,onChange:e=>o(e.target.value),required:!0,className:"mt-1 w-full border rounded-md p-2 text-sm dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., Daily Food Specials"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"group-id",className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:["WhatsApp Group ID",(0,s.jsxs)("div",{className:"group relative ml-2",children:[s.jsx(u.Z,{size:14,className:"text-gray-400"}),s.jsx("div",{className:"absolute bottom-full mb-2 w-64 bg-black text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:"To get the Group ID, temporarily add your business number to the group, send any message, and check your webhook logs for the 'from' field (e.g., '12345-67890@g.us')."})]})]}),s.jsx("input",{id:"group-id",type:"text",value:i,onChange:e=>d(e.target.value),required:!0,disabled:!!e,className:"mt-1 w-full border rounded-md p-2 text-sm font-mono disabled:bg-gray-100 dark:disabled:bg-gray-800/50 dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., 1234567890-12345678@g.us"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm border dark:border-gray-600 rounded-md",children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",disabled:c,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-md disabled:opacity-50 flex items-center",children:[c&&s.jsx(x.Z,{className:"animate-spin mr-2",size:16}),c?"Saving...":"Save Group"]})]})]})})};var m=r(94602),h=r(90434),y=r(30058);let b=()=>{let[e,t]=(0,a.useState)([]),[r,p]=(0,a.useState)(!0),[u,x]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),j=async()=>{p(!0);try{let e=await fetch("/api/groups");if(e.ok){let r=await e.json();t(r)}}catch(e){console.error("Failed to fetch groups",e)}finally{p(!1)}};(0,a.useEffect)(()=>{j()},[]);let v=(e=null)=>{f(e),x(!0)},k=async e=>{window.confirm("Are you sure you want to unregister this group? This will not affect the group on WhatsApp.")&&(await fetch(`/api/groups/${e}`,{method:"DELETE"}),j())};return r?s.jsx("div",{className:"p-8 text-center flex items-center justify-center h-full",children:s.jsx(c.Z,{})}):(0,s.jsxs)("div",{className:"p-6 md:p-8 dark:bg-gray-900/50 min-h-full",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"WhatsApp Groups"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage and communicate with your registered WhatsApp groups."})]}),(0,s.jsxs)("button",{onClick:()=>v(),className:"bg-blue-600 text-white px-4 py-2 rounded-md flex items-center shadow-sm hover:bg-blue-700",children:[s.jsx(l.Z,{size:16,className:"mr-2"})," Register Group"]})]}),0===e.length?(0,s.jsxs)("div",{className:"text-center py-20 border-2 border-dashed rounded-lg",children:[s.jsx(n.Z,{size:48,className:"mx-auto text-gray-400"}),s.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-800 dark:text-gray-200",children:"No Groups Registered"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Click 'Register Group' to start managing a WhatsApp group."})]}):s.jsx(y.E.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsxs)(y.E.div,{className:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:e.name}),(0,s.jsxs)("div",{className:"flex space-x-1",children:[s.jsx("button",{onClick:()=>v(e),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:s.jsx(o.Z,{size:16})}),s.jsx("button",{onClick:()=>k(e.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:s.jsx(i.Z,{size:16})})]})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono mt-1 break-all",children:e.whatsappGroupId}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:["Last message: ",e.lastMessageAt?(0,m.Q)(new Date(e.lastMessageAt),{addSuffix:!0}):"Never"]})]}),s.jsx("div",{className:"mt-4",children:(0,s.jsxs)(h.default,{href:`/groups/${e.id}`,className:"w-full bg-green-500 text-white px-4 py-2 rounded-md flex items-center justify-center text-sm font-semibold hover:bg-green-600",children:[s.jsx(d,{size:16,className:"mr-2"})," Open Chat"]})})]},e.id))}),u&&s.jsx(g,{group:b,isOpen:u,onClose:()=>{x(!1),f(null)},onSuccess:()=>{x(!1),f(null),j()}})]})}},28676:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(10326);r(17577);let a=({isOpen:e,onClose:t,title:r,children:a})=>e?s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",onClick:t,children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md m-4",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:r}),s.jsx("button",{onClick:t,className:"text-gray-500 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100",children:"\xd7"})]}),s.jsx("div",{className:"p-4",children:a})]})}):null},85958:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>o});var s=r(68570);let a=(0,s.createProxy)(String.raw`C:\vyaparconnect-crm\src\app\groups\page.tsx`),{__esModule:l,$$typeof:n}=a;a.default;let o=(0,s.createProxy)(String.raw`C:\vyaparconnect-crm\src\app\groups\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,4890,7344,4602,1833],()=>r(74351));module.exports=s})();