(()=>{var e={};e.id=1569,e.ids=[1569],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},17679:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>g,tree:()=>c}),s(25925),s(95499),s(72110),s(35866);var a=s(23191),r=s(88716),l=s(37922),i=s.n(l),d=s(95231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(t,n);let c=["",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,25925)),"C:\\vyaparconnect-crm\\src\\app\\orders\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,95499)),"C:\\vyaparconnect-crm\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,72110)),"C:\\vyaparconnect-crm\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\vyaparconnect-crm\\src\\app\\orders\\page.tsx"],m="/orders/page",x={require:s,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/orders/page",pathname:"/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},55886:(e,t,s)=>{Promise.resolve().then(s.bind(s,61865))},61865:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var a=s(10326),r=s(17577),l=s(30058),i=s(88129),d=s(90434),n=s(24422),c=s(45804);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,s(62881).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var m=s(77506),x=s(78539);let g=["PENDING","CONFIRMED","SHIPPED","DELIVERED","CANCELLED"],p=["PENDING","PROCESSING","SHIPPED","DELIVERED","CANCELLED"],u={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},h=({order:e,isExpanded:t,onToggle:s,onUpdate:h})=>{let[y,j]=(0,r.useState)(null),b=async t=>{if(t!==e.status){j("order");try{if(!(await fetch(`/api/orders/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)throw Error("Failed to update status");h()}catch(e){console.error(e)}finally{j(null)}}},N=async(t,s)=>{let a=e.items.find(e=>e.id===t);if(a&&a.status!==s){j(t);try{if(!(await fetch(`/api/orders/items/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})})).ok)throw Error("Failed to update item status");h()}catch(e){console.error(e)}finally{j(null)}}},v=e.items.length>1?`${e.items[0].productName||"Item"} & ${e.items.length-1} more`:e.items[0]?.productName||"Item not specified",f=e.payments?.reduce((e,t)=>e+t.amount,0)||0,w=e.total-f;return(0,a.jsxs)(l.E.div,{layout:!0,variants:u,className:"bg-white dark:bg-[var(--card-background)] rounded-lg shadow-sm border dark:border-[var(--card-border)] overflow-hidden",children:[(0,a.jsxs)(l.E.div,{layout:!0,className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-200 cursor-pointer",onClick:s,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[(0,a.jsxs)("div",{className:"md:col-span-3",children:[a.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-100 text-lg",children:e.customerName}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",children:v})]}),a.jsx("div",{className:"md:col-span-1 text-left md:text-right",children:(0,a.jsxs)("p",{className:"font-semibold text-lg dark:text-gray-100",children:["₹",e.total.toLocaleString("en-IN")]})}),(0,a.jsxs)("div",{className:"md:col-span-2 flex justify-between md:justify-end items-center",children:[a.jsx(n.Z,{status:e.status}),a.jsx(l.E.div,{layout:"position",children:a.jsx(o,{size:20,className:`ml-4 text-gray-400 transition-transform ${t?"rotate-180":""}`})})]})]}),(0,a.jsxs)("div",{className:"mt-3 pt-3 flex justify-between items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("div",{children:["ID: ",(0,a.jsxs)("span",{className:"font-mono text-xs",children:[e.id.substring(0,8),"..."]}),a.jsx("span",{className:"mx-2",children:"|"}),(0,c.WU)(new Date(e.createdAt),"dd MMM, yyyy")]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx(d.default,{href:`/chat?contactId=${e.contactId}`,onClick:e=>e.stopPropagation(),className:"p-2 text-green-600 bg-green-50 dark:bg-green-900/30 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/50 rounded-full",title:"Chat with Customer",children:a.jsx(x.Z,{name:"messageCircle",size:18})})})]})]}),a.jsx(i.M,{initial:!1,children:t&&a.jsx(l.E.section,{initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},children:a.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/60 border-t dark:border-[var(--card-border)] text-sm",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h4",{className:"font-semibold text-sm text-gray-800 dark:text-gray-100",children:"Order Items"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["order"===y&&a.jsx(m.Z,{size:16,className:"animate-spin text-gray-500"}),a.jsx("select",{value:e.status,onChange:e=>b(e.target.value),className:"text-xs border rounded-md p-1 bg-white dark:bg-gray-700 dark:border-gray-600",disabled:"order"===y,onClick:e=>e.stopPropagation(),children:g.map(e=>a.jsx("option",{value:e,children:e},e))})]})]}),(0,a.jsxs)("table",{className:"w-full text-xs",children:[a.jsx("thead",{className:"text-left bg-gray-200 dark:bg-gray-700",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"p-2",children:"Item"}),a.jsx("th",{className:"p-2",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:e.items.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{className:"p-2 font-medium",children:[e.productName," (",e.quantity,")"]}),a.jsx("td",{className:"p-2",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("select",{value:e.status,onChange:t=>N(e.id,t.target.value),className:"w-full border rounded-md p-1 text-xs bg-white dark:bg-gray-800 dark:border-gray-600",disabled:y===e.id,onClick:e=>e.stopPropagation(),children:p.map(e=>a.jsx("option",{value:e,children:e},e))}),y===e.id&&a.jsx(m.Z,{size:14,className:"animate-spin text-gray-500 ml-2"})]})})]},e.id))})]})]}),a.jsx("div",{children:(0,a.jsxs)("div",{className:"p-3 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900/50",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2 text-gray-800 dark:text-gray-100",children:"Payment Summary"}),(0,a.jsxs)("div",{className:"text-sm space-y-1 text-gray-700 dark:text-gray-300",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total Bill:"})," ",(0,a.jsxs)("span",{className:"font-bold text-gray-800 dark:text-gray-100",children:["₹",e.total.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total Paid:"})," ",(0,a.jsxs)("span",{className:"font-bold text-green-600 dark:text-green-400",children:["₹",f.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Amount Due:"})," ",(0,a.jsxs)("span",{className:"font-bold text-red-600 dark:text-red-400",children:["₹",w.toFixed(2)]})]})]})]})})]})})},"content")})]})};var y=s(17334);let j=()=>(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[(0,a.jsxs)("div",{className:"md:col-span-3 space-y-2",children:[a.jsx(y.Z,{className:"h-6 w-3/5"}),a.jsx(y.Z,{className:"h-4 w-4/5"})]}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(y.Z,{className:"h-6 w-3/4"})}),a.jsx("div",{className:"md:col-span-2 flex justify-start md:justify-end",children:a.jsx(y.Z,{className:"h-6 w-20 rounded-full"})})]}),(0,a.jsxs)("div",{className:"border-t dark:border-gray-700 mt-3 pt-3 flex justify-between items-center",children:[a.jsx(y.Z,{className:"h-4 w-1/3"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(y.Z,{className:"h-8 w-8 rounded-full"}),a.jsx(y.Z,{className:"h-8 w-8 rounded-full"})]})]})]}),b=()=>(0,a.jsxs)("div",{className:"p-6 md:p-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:(0,a.jsxs)("div",{children:[a.jsx(y.Z,{className:"h-8 w-64"}),a.jsx(y.Z,{className:"h-4 w-80 mt-2"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"lg:col-span-3 space-y-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>a.jsx(j,{},t))}),a.jsx("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border dark:border-gray-700 text-center",children:[a.jsx(y.Z,{className:"h-12 w-16 mx-auto"}),a.jsx(y.Z,{className:"h-4 w-32 mx-auto mt-2"})]})})]})]});var N=s(92977),v=s(71271);let f={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.07}}},w=()=>{let[e,t]=(0,r.useState)([]),[s,d]=(0,r.useState)(!0),[n,c]=(0,r.useState)(null),[o,m]=(0,r.useState)(null),[g,p]=(0,r.useState)("all"),[u,y]=(0,r.useState)(0),j=(0,r.useCallback)(async()=>{d(!0);try{let e=await fetch("/api/orders");if(!e.ok)throw Error("Failed to load orders.");let s=await e.json();t(s)}catch(e){c(e.message)}finally{d(!1)}},[]);(0,r.useEffect)(()=>{j()},[j,u]);let w=(0,r.useMemo)(()=>{let t;if("all"===g)return e;let s=new Date;if("today"===g){let e=new Date;e.setHours(0,0,0,0),t=e}else t="7d"===g?(0,N.E)(s,-7):(0,N.E)(s,-30);return e.filter(e=>(function(e,t){let s=(0,v.Q)(e),a=(0,v.Q)(t);return s.getTime()>a.getTime()})(new Date(e.createdAt),t))},[e,g]),k=(0,r.useMemo)(()=>{let e=w.reduce((e,t)=>e+t.total,0);return{count:w.length,totalValue:e}},[w]);return s?a.jsx(b,{}):(0,a.jsxs)("div",{className:"p-6 md:p-8 bg-gray-50/50 dark:bg-transparent min-h-full",children:[(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex justify-between items-start mb-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Order Management"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Track and manage all direct customer orders."})]}),a.jsx("div",{className:"flex items-center space-x-2 bg-gray-200 dark:bg-gray-700 p-1 rounded-lg",children:["all","today","7d","30d"].map(e=>a.jsx("button",{onClick:()=>p(e),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${g===e?"bg-white dark:bg-gray-800 text-blue-600 shadow-sm":"text-gray-600 dark:text-gray-300"}`,children:"all"===e?"All Time":"today"===e?"Today":`Last ${e.replace("d","")} Days`},e))})]}),n&&a.jsx("p",{className:"text-red-500 bg-red-100 p-3 rounded-md text-center mb-4",children:n}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[a.jsx(l.E.div,{layout:!0,className:"lg:col-span-3 space-y-4",variants:f,initial:"hidden",animate:"visible",children:a.jsx(i.M,{children:w.length>0?w.map(e=>a.jsx(h,{order:e,isExpanded:e.id===o,onToggle:()=>m(t=>t===e.id?null:e.id),onUpdate:()=>y(e=>e+1)},e.id)):(0,a.jsxs)(l.E.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-16 bg-white rounded-lg border",children:[a.jsx(x.Z,{name:"package",size:40,className:"mx-auto text-gray-300"}),a.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-700",children:"No Orders Found"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No orders match the current filter."})]})})}),a.jsx("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border text-center sticky top-6",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Filtered Orders"}),a.jsx("p",{className:"text-5xl font-bold text-blue-600 mt-1",children:k.count}),a.jsx("p",{className:"text-sm font-medium text-gray-600 mt-4",children:"Total Value"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-green-600 mt-1",children:["₹",k.totalValue.toLocaleString("en-IN")]})]})})]})]})}},24422:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var a=s(10326);s(17577);let r={PENDING:{label:"Pending",className:"bg-yellow-100 text-yellow-800"},CONFIRMED:{label:"Confirmed",className:"bg-blue-100 text-blue-700"},SHIPPED:{label:"Shipped",className:"bg-indigo-100 text-indigo-700"},DELIVERED:{label:"Delivered",className:"bg-green-100 text-green-700"},CANCELLED:{label:"Cancelled",className:"bg-red-100 text-red-700"}},l=({status:e})=>{let t=r[e]||{label:"Unknown",className:"bg-gray-100 text-gray-700"};return a.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full inline-block ${t.className}`,children:t.label})}},17334:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(10326);s(17577);let r=({className:e,...t})=>a.jsx("div",{className:function(...e){return e.filter(Boolean).join(" ")}("animate-pulse rounded-md bg-gray-200 dark:bg-gray-700",e),...t})},25925:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>d});var a=s(68570);let r=(0,a.createProxy)(String.raw`C:\vyaparconnect-crm\src\app\orders\page.tsx`),{__esModule:l,$$typeof:i}=r;r.default;let d=(0,a.createProxy)(String.raw`C:\vyaparconnect-crm\src\app\orders\page.tsx#default`)},92977:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var a=s(71271),r=s(99276);function l(e,t){let s=(0,a.Q)(e);return isNaN(t)?(0,r.L)(e,NaN):(t&&s.setDate(s.getDate()+t),s)}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,737,7344,5804,9393],()=>s(17679));module.exports=a})();