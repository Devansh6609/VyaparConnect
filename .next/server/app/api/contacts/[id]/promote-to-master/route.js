"use strict";(()=>{var e={};e.id=1243,e.ids=[1243],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},58422:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>u,serverHooks:()=>h,staticGenerationAsyncStorage:()=>l});var o={};r.r(o),r.d(o,{POST:()=>d});var a=r(49303),s=r(88716),n=r(60670),i=r(87070),c=r(20728),p=r(21178);async function d(e,{params:t}){let r=t.id;try{let{name:t,shippingAddress:o,bankDetails:a,tagIds:s}=await e.json();if(!t||!o)return i.NextResponse.json({error:"Name and Shipping Address are required."},{status:400});let n=await c.Z.contact.update({where:{id:r},data:{isMasterCustomer:!0,name:t,shippingAddress:o,bankDetails:a,tags:{set:Array.isArray(s)?s.map(e=>({id:e})):[]}},include:{tags:!0}});return await (0,p.F)("contact_updated",n),i.NextResponse.json(n,{status:200})}catch(e){return console.error(`Failed to promote or update master contact ${r}:`,e),i.NextResponse.json({error:"Failed to save customer details"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/contacts/[id]/promote-to-master/route",pathname:"/api/contacts/[id]/promote-to-master",filename:"route",bundlePath:"app/api/contacts/[id]/promote-to-master/route"},resolvedPagePath:"C:\\vyaparconnect-crm\\src\\app\\api\\contacts\\[id]\\promote-to-master\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:h}=u,v="/api/contacts/[id]/promote-to-master/route";function g(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:l})}},20728:(e,t,r)=>{r.d(t,{Z:()=>a});let o=require("@prisma/client"),a=globalThis.prisma||new o.PrismaClient},21178:(e,t,r)=>{r.d(t,{F:()=>o});async function o(e,t){try{let r=process.env.PORT||"3000",o=`http://localhost:${r}/api/socket/emit`,a=process.env.SOCKET_EMITTER_SECRET;if(!a){console.error("SOCKET_EMITTER_SECRET is not defined. Cannot emit socket event.");return}fetch(o,{method:"POST",headers:{"Content-Type":"application/json","x-emitter-secret":a},body:JSON.stringify({event:e,data:t})}).catch(t=>{console.error(`Failed to emit socket event '${e}' to ${o}:`,t.message)})}catch(e){console.error("Error preparing socket event emission:",e)}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[8948,5972],()=>r(58422));module.exports=o})();