(()=>{var e={};e.id=4547,e.ids=[4547],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},89908:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>C,requestAsyncStorage:()=>y,routeModule:()=>R,serverHooks:()=>O,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{POST:()=>h});var a=r(49303),n=r(88716),i=r(60670),o=r(87070),u=r(20728),c=r(41212),l=r.n(c);let p=process.env.RAZORPAY_KEY_ID||"",d=process.env.RAZORPAY_KEY_SECRET||"",m=new(l())({key_id:p,key_secret:d});async function h(e,t){let{id:r}=await t.params;try{let e=await u.Z.quotation.findUnique({where:{id:r}});if(!e)return o.NextResponse.json({error:"Quotation not found"},{status:404});let t=await m.paymentLink.create({amount:Math.round(100*e.total),currency:"INR",description:`Payment for Quotation #${e.id}`,customer:{name:e.customerName,contact:e.contactNumber},notify:{sms:!0,email:!1},reminder_enable:!0,notes:{quotation_id:e.id},callback_url:"https://e3e2fbab318c.ngrok-free.app/payment-success",callback_method:"get"});return await u.Z.quotation.update({where:{id:r},data:{paymentLinkId:t.id,paymentLinkUrl:t.short_url}}),o.NextResponse.json({success:!0,paymentLinkUrl:t.short_url})}catch(e){return console.error("Failed to create Razorpay payment link:",e),o.NextResponse.json({error:e.message||"Failed to create payment link"},{status:500})}}let R=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/quotations/[id]/create-payment-link/route",pathname:"/api/quotations/[id]/create-payment-link",filename:"route",bundlePath:"app/api/quotations/[id]/create-payment-link/route"},resolvedPagePath:"C:\\vyaparconnect-crm\\src\\app\\api\\quotations\\[id]\\create-payment-link\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:O}=R,x="/api/quotations/[id]/create-payment-link/route";function C(){return(0,i.patchFetch)({serverHooks:O,staticGenerationAsyncStorage:f})}},72616:e=>{"use strict";e.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":1===e.length?"-":"--",s=t.indexOf(r+e),a=t.indexOf("--");return -1!==s&&(-1===a||s<a)}},13974:e=>{function t(e,t,r,s){return Math.round(e/r)+" "+s+(t>=1.5*r?"s":"")}e.exports=function(e,r){r=r||{};var s,a,n=typeof e;if("string"===n&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===n&&isFinite(e))return r.long?(s=Math.abs(e))>=864e5?t(e,s,864e5,"day"):s>=36e5?t(e,s,36e5,"hour"):s>=6e4?t(e,s,6e4,"minute"):s>=1e3?t(e,s,1e3,"second"):e+" ms":(a=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":a>=36e5?Math.round(e/36e5)+"h":a>=6e4?Math.round(e/6e4)+"m":a>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},67057:(e,t,r)=>{"use strict";let s;let a=r(22037),n=r(76224),i=r(72616),{env:o}=process;function u(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function c(e,t){if(0===s)return 0;if(i("color=16m")||i("color=full")||i("color=truecolor"))return 3;if(i("color=256"))return 2;if(e&&!t&&void 0===s)return 0;let r=s||0;if("dumb"===o.TERM)return r;if("win32"===process.platform){let e=a.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(e=>e in o)||"codeship"===o.CI_NAME?1:r;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){let e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:r}i("no-color")||i("no-colors")||i("color=false")||i("color=never")?s=0:(i("color")||i("colors")||i("color=true")||i("color=always"))&&(s=1),"FORCE_COLOR"in o&&(s="true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(parseInt(o.FORCE_COLOR,10),3)),e.exports={supportsColor:function(e){return u(c(e,e&&e.isTTY))},stdout:u(c(!0,n.isatty(1))),stderr:u(c(!0,n.isatty(2)))}},20728:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let s=require("@prisma/client"),a=globalThis.prisma||new s.PrismaClient}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972,1212],()=>r(89908));module.exports=s})();