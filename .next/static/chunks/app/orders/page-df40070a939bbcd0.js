(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{1585:function(e,a,t){Promise.resolve().then(t.bind(t,6690))},6690:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var s=t(7437),r=t(2265),l=t(1513),i=t(4446),d=t(7138),n=t(4727),c=t(4729);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,t(8030).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var m=t(3274),x=t(9788);let g=["PENDING","CONFIRMED","SHIPPED","DELIVERED","CANCELLED"],h=["PENDING","PROCESSING","SHIPPED","DELIVERED","CANCELLED"],u={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};var p=e=>{var a,t;let{order:p,isExpanded:y,onToggle:j,onUpdate:N}=e,[b,f]=(0,r.useState)(null),v=async e=>{if(e!==p.status){f("order");try{if(!(await fetch("/api/orders/".concat(p.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})})).ok)throw Error("Failed to update status");N()}catch(e){console.error(e)}finally{f(null)}}},k=async(e,a)=>{let t=p.items.find(a=>a.id===e);if(t&&t.status!==a){f(e);try{if(!(await fetch("/api/orders/items/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})})).ok)throw Error("Failed to update item status");N()}catch(e){console.error(e)}finally{f(null)}}},w=p.items.length>1?"".concat(p.items[0].productName||"Item"," & ").concat(p.items.length-1," more"):(null===(a=p.items[0])||void 0===a?void 0:a.productName)||"Item not specified",Z=(null===(t=p.payments)||void 0===t?void 0:t.reduce((e,a)=>e+a.amount,0))||0,E=p.total-Z;return(0,s.jsxs)(l.E.div,{layout:!0,variants:u,className:"bg-white dark:bg-[var(--card-background)] rounded-lg shadow-sm border dark:border-[var(--card-border)] overflow-hidden",children:[(0,s.jsxs)(l.E.div,{layout:!0,className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors duration-200 cursor-pointer",onClick:j,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[(0,s.jsxs)("div",{className:"md:col-span-3",children:[(0,s.jsx)("p",{className:"font-bold text-gray-800 dark:text-gray-100 text-lg",children:p.customerName}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",children:w})]}),(0,s.jsx)("div",{className:"md:col-span-1 text-left md:text-right",children:(0,s.jsxs)("p",{className:"font-semibold text-lg dark:text-gray-100",children:["₹",p.total.toLocaleString("en-IN")]})}),(0,s.jsxs)("div",{className:"md:col-span-2 flex justify-between md:justify-end items-center",children:[(0,s.jsx)(n.Z,{status:p.status}),(0,s.jsx)(l.E.div,{layout:"position",children:(0,s.jsx)(o,{size:20,className:"ml-4 text-gray-400 transition-transform ".concat(y?"rotate-180":"")})})]})]}),(0,s.jsxs)("div",{className:"mt-3 pt-3 flex justify-between items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,s.jsxs)("div",{children:["ID: ",(0,s.jsxs)("span",{className:"font-mono text-xs",children:[p.id.substring(0,8),"..."]}),(0,s.jsx)("span",{className:"mx-2",children:"|"}),(0,c.WU)(new Date(p.createdAt),"dd MMM, yyyy")]}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)(d.default,{href:"/chat?contactId=".concat(p.contactId),onClick:e=>e.stopPropagation(),className:"p-2 text-green-600 bg-green-50 dark:bg-green-900/30 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/50 rounded-full",title:"Chat with Customer",children:(0,s.jsx)(x.Z,{name:"messageCircle",size:18})})})]})]}),(0,s.jsx)(i.M,{initial:!1,children:y&&(0,s.jsx)(l.E.section,{initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},children:(0,s.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/60 border-t dark:border-[var(--card-border)] text-sm",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("h4",{className:"font-semibold text-sm text-gray-800 dark:text-gray-100",children:"Order Items"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:["order"===b&&(0,s.jsx)(m.Z,{size:16,className:"animate-spin text-gray-500"}),(0,s.jsx)("select",{value:p.status,onChange:e=>v(e.target.value),className:"text-xs border rounded-md p-1 bg-white dark:bg-gray-700 dark:border-gray-600",disabled:"order"===b,onClick:e=>e.stopPropagation(),children:g.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]}),(0,s.jsxs)("table",{className:"w-full text-xs",children:[(0,s.jsx)("thead",{className:"text-left bg-gray-200 dark:bg-gray-700",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-2",children:"Item"}),(0,s.jsx)("th",{className:"p-2",children:"Status"})]})}),(0,s.jsx)("tbody",{className:"divide-y dark:divide-gray-700",children:p.items.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"p-2 font-medium",children:[e.productName," (",e.quantity,")"]}),(0,s.jsx)("td",{className:"p-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("select",{value:e.status,onChange:a=>k(e.id,a.target.value),className:"w-full border rounded-md p-1 text-xs bg-white dark:bg-gray-800 dark:border-gray-600",disabled:b===e.id,onClick:e=>e.stopPropagation(),children:h.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),b===e.id&&(0,s.jsx)(m.Z,{size:14,className:"animate-spin text-gray-500 ml-2"})]})})]},e.id))})]})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"p-3 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900/50",children:[(0,s.jsx)("h4",{className:"font-semibold text-sm mb-2 text-gray-800 dark:text-gray-100",children:"Payment Summary"}),(0,s.jsxs)("div",{className:"text-sm space-y-1 text-gray-700 dark:text-gray-300",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Total Bill:"})," ",(0,s.jsxs)("span",{className:"font-bold text-gray-800 dark:text-gray-100",children:["₹",p.total.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Total Paid:"})," ",(0,s.jsxs)("span",{className:"font-bold text-green-600 dark:text-green-400",children:["₹",Z.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Amount Due:"})," ",(0,s.jsxs)("span",{className:"font-bold text-red-600 dark:text-red-400",children:["₹",E.toFixed(2)]})]})]})]})})]})})},"content")})]})},y=t(1339);let j=()=>(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[(0,s.jsxs)("div",{className:"md:col-span-3 space-y-2",children:[(0,s.jsx)(y.Z,{className:"h-6 w-3/5"}),(0,s.jsx)(y.Z,{className:"h-4 w-4/5"})]}),(0,s.jsx)("div",{className:"md:col-span-1",children:(0,s.jsx)(y.Z,{className:"h-6 w-3/4"})}),(0,s.jsx)("div",{className:"md:col-span-2 flex justify-start md:justify-end",children:(0,s.jsx)(y.Z,{className:"h-6 w-20 rounded-full"})})]}),(0,s.jsxs)("div",{className:"border-t dark:border-gray-700 mt-3 pt-3 flex justify-between items-center",children:[(0,s.jsx)(y.Z,{className:"h-4 w-1/3"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(y.Z,{className:"h-8 w-8 rounded-full"}),(0,s.jsx)(y.Z,{className:"h-8 w-8 rounded-full"})]})]})]});var N=()=>(0,s.jsxs)("div",{className:"p-6 md:p-8",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(y.Z,{className:"h-8 w-64"}),(0,s.jsx)(y.Z,{className:"h-4 w-80 mt-2"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-3 space-y-4",children:[void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsx)(j,{},a))}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border dark:border-gray-700 text-center",children:[(0,s.jsx)(y.Z,{className:"h-12 w-16 mx-auto"}),(0,s.jsx)(y.Z,{className:"h-4 w-32 mx-auto mt-2"})]})})]})]}),b=t(2781),f=t(4546);let v={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.07}}};var k=()=>{let[e,a]=(0,r.useState)([]),[t,d]=(0,r.useState)(!0),[n,c]=(0,r.useState)(null),[o,m]=(0,r.useState)(null),[g,h]=(0,r.useState)("all"),[u,y]=(0,r.useState)(0),j=(0,r.useCallback)(async()=>{d(!0);try{let e=await fetch("/api/orders");if(!e.ok)throw Error("Failed to load orders.");let t=await e.json();a(t)}catch(e){c(e.message)}finally{d(!1)}},[]);(0,r.useEffect)(()=>{j()},[j,u]);let k=(0,r.useMemo)(()=>{let a;if("all"===g)return e;let t=new Date;if("today"===g){let e=new Date;e.setHours(0,0,0,0),a=e}else a="7d"===g?(0,b.E)(t,-7):(0,b.E)(t,-30);return e.filter(e=>(function(e,a){let t=(0,f.Q)(e),s=(0,f.Q)(a);return t.getTime()>s.getTime()})(new Date(e.createdAt),a))},[e,g]),w=(0,r.useMemo)(()=>{let e=k.reduce((e,a)=>e+a.total,0);return{count:k.length,totalValue:e}},[k]);return t?(0,s.jsx)(N,{}):(0,s.jsxs)("div",{className:"p-6 md:p-8 bg-gray-50/50 dark:bg-transparent min-h-full",children:[(0,s.jsxs)(l.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex justify-between items-start mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Order Management"}),(0,s.jsx)("p",{className:"text-gray-500 mt-1",children:"Track and manage all direct customer orders."})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2 bg-gray-200 dark:bg-gray-700 p-1 rounded-lg",children:["all","today","7d","30d"].map(e=>(0,s.jsx)("button",{onClick:()=>h(e),className:"px-3 py-1 text-sm font-semibold rounded-md transition-colors ".concat(g===e?"bg-white dark:bg-gray-800 text-blue-600 shadow-sm":"text-gray-600 dark:text-gray-300"),children:"all"===e?"All Time":"today"===e?"Today":"Last ".concat(e.replace("d","")," Days")},e))})]}),n&&(0,s.jsx)("p",{className:"text-red-500 bg-red-100 p-3 rounded-md text-center mb-4",children:n}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(l.E.div,{layout:!0,className:"lg:col-span-3 space-y-4",variants:v,initial:"hidden",animate:"visible",children:(0,s.jsx)(i.M,{children:k.length>0?k.map(e=>(0,s.jsx)(p,{order:e,isExpanded:e.id===o,onToggle:()=>m(a=>a===e.id?null:e.id),onUpdate:()=>y(e=>e+1)},e.id)):(0,s.jsxs)(l.E.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-16 bg-white rounded-lg border",children:[(0,s.jsx)(x.Z,{name:"package",size:40,className:"mx-auto text-gray-300"}),(0,s.jsx)("h3",{className:"mt-2 text-lg font-medium text-gray-700",children:"No Orders Found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"No orders match the current filter."})]})})}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border text-center sticky top-6",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Filtered Orders"}),(0,s.jsx)("p",{className:"text-5xl font-bold text-blue-600 mt-1",children:w.count}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 mt-4",children:"Total Value"}),(0,s.jsxs)("p",{className:"text-3xl font-bold text-green-600 mt-1",children:["₹",w.totalValue.toLocaleString("en-IN")]})]})})]})]})}},4727:function(e,a,t){"use strict";var s=t(7437);t(2265);let r={PENDING:{label:"Pending",className:"bg-yellow-100 text-yellow-800"},CONFIRMED:{label:"Confirmed",className:"bg-blue-100 text-blue-700"},SHIPPED:{label:"Shipped",className:"bg-indigo-100 text-indigo-700"},DELIVERED:{label:"Delivered",className:"bg-green-100 text-green-700"},CANCELLED:{label:"Cancelled",className:"bg-red-100 text-red-700"}};a.Z=e=>{let{status:a}=e,t=r[a]||{label:"Unknown",className:"bg-gray-100 text-gray-700"};return(0,s.jsx)("span",{className:"px-2.5 py-1 text-xs font-semibold rounded-full inline-block ".concat(t.className),children:t.label})}},9788:function(e,a,t){"use strict";var s=t(7437);t(2265);var r=t(4207),l=t(6780),i=t(8711),d=t(2468),n=t(2638),c=t(933),o=t(8314),m=t(6935),x=t(1077),g=t(7164),h=t(6649),u=t(9827),p=t(2023),y=t(404),j=t(8604),N=t(7140),b=t(9100),f=t(4453),v=t(7583),k=t(7524),w=t(6863),Z=t(5404),E=t(4258),C=t(1510),D=t(1125),I=t(3907),P=t(8637),S=t(883),L=t(2022),T=t(3267),O=t(9099),F=t(1240),M=t(4697);let A={activity:r.Z,alertCircle:l.Z,barChart3:i.Z,check:d.Z,checkCheck:n.Z,clock:c.Z,combine:o.Z,creditCard:m.Z,dollarSign:x.Z,download:g.Z,edit:h.Z,file:u.Z,fileText:p.Z,filter:y.Z,image:j.Z,layoutDashboard:N.Z,lineChart:b.Z,lock:f.Z,messageCircle:v.Z,package:k.Z,pieChart:w.Z,radio:Z.Z,settings:E.Z,share2:C.Z,slidersHorizontal:D.Z,sparkles:I.Z,sunrise:P.Z,trash2:S.Z,user:L.Z,userPlus:T.Z,userX:O.Z,users:F.Z,x:M.Z},z=e=>e?e.charAt(0).toLowerCase()+e.slice(1):"alertCircle";a.Z=e=>{let{name:a,...t}=e,r=z(a),i=A[r];return i?(0,s.jsx)(i,{...t}):(console.warn('Icon "'.concat(a,'" (normalized to "').concat(r,'") not found in the icon map. Rendering a fallback icon.')),(0,s.jsx)(l.Z,{...t,color:"red"}))}},1339:function(e,a,t){"use strict";var s=t(7437);t(2265),a.Z=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter(Boolean).join(" ")}("animate-pulse rounded-md bg-gray-200 dark:bg-gray-700",a),...t})}},2781:function(e,a,t){"use strict";t.d(a,{E:function(){return l}});var s=t(4546),r=t(1880);function l(e,a){let t=(0,s.Q)(e);return isNaN(a)?(0,r.L)(e,NaN):(a&&t.setDate(t.getDate()+a),t)}}},function(e){e.O(0,[862,138,213,792,756,971,23,744],function(){return e(e.s=1585)}),_N_E=e.O()}]);