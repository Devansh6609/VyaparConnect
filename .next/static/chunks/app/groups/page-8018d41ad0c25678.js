(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[586],{720:function(e,t,r){Promise.resolve().then(r.bind(r,1441))},8030:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var s=r(2265);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ")};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:u,...x}=e;return(0,s.createElement)("svg",{ref:t,...l,width:a,height:a,stroke:r,strokeWidth:o?24*Number(n)/Number(a):n,className:i("lucide",d),...x},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),o=(e,t)=>{let r=(0,s.forwardRef)((r,l)=>{let{className:o,...d}=r;return(0,s.createElement)(n,{ref:l,iconNode:t,className:i("lucide-".concat(a(e)),o),...d})});return r.displayName="".concat(e),r}},9687:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(8030).Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3274:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(8030).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2513:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(8030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6649:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(8030).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},883:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(8030).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1240:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(8030).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},1441:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var s=r(7437),a=r(2265),i=r(2513),l=r(1240),n=r(6649),o=r(883);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,r(8030).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var c=r(3258),u=r(5260),x=r(9687),m=r(3274),h=e=>{let{group:t,isOpen:r,onClose:i,onSuccess:l}=e,[n,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),[p,y]=(0,a.useState)("");(0,a.useEffect)(()=>{r&&(t?(o(t.name),c(t.whatsappGroupId)):(o(""),c("")),y(""))},[t,r]);let f=async e=>{e.preventDefault(),g(!0),y("");try{let e=t?"/api/groups/".concat(t.id):"/api/groups",r=t?{name:n}:{name:n,whatsappGroupId:d},s=await fetch(e,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to save group.");l()}catch(e){y(e.message)}finally{g(!1)}};return(0,s.jsx)(u.Z,{isOpen:r,onClose:i,title:t?"Edit Group":"Register New Group",children:(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[p&&(0,s.jsx)("p",{className:"text-red-600 bg-red-50 dark:bg-red-900/20 p-2 rounded-md text-sm",children:p}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"group-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Group Display Name"}),(0,s.jsx)("input",{id:"group-name",type:"text",value:n,onChange:e=>o(e.target.value),required:!0,className:"mt-1 w-full border rounded-md p-2 text-sm dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., Daily Food Specials"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"group-id",className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:["WhatsApp Group ID",(0,s.jsxs)("div",{className:"group relative ml-2",children:[(0,s.jsx)(x.Z,{size:14,className:"text-gray-400"}),(0,s.jsx)("div",{className:"absolute bottom-full mb-2 w-64 bg-black text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:"To get the Group ID, temporarily add your business number to the group, send any message, and check your webhook logs for the 'from' field (e.g., '12345-67890@g.us')."})]})]}),(0,s.jsx)("input",{id:"group-id",type:"text",value:d,onChange:e=>c(e.target.value),required:!0,disabled:!!t,className:"mt-1 w-full border rounded-md p-2 text-sm font-mono disabled:bg-gray-100 dark:disabled:bg-gray-800/50 dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., 1234567890-12345678@g.us"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:i,className:"px-4 py-2 text-sm border dark:border-gray-600 rounded-md",children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",disabled:h,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-md disabled:opacity-50 flex items-center",children:[h&&(0,s.jsx)(m.Z,{className:"animate-spin mr-2",size:16}),h?"Saving...":"Save Group"]})]})]})})},g=r(6563),p=r(7138),y=()=>{let[e,t]=(0,a.useState)([]),[r,u]=(0,a.useState)(!0),[x,m]=(0,a.useState)(!1),[y,f]=(0,a.useState)(null),b=async()=>{u(!0);try{let e=await fetch("/api/groups");if(e.ok){let r=await e.json();t(r)}}catch(e){console.error("Failed to fetch groups",e)}finally{u(!1)}};(0,a.useEffect)(()=>{b()},[]);let k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;f(e),m(!0)},j=async e=>{window.confirm("Are you sure you want to unregister this group? This will not affect the group on WhatsApp.")&&(await fetch("/api/groups/".concat(e),{method:"DELETE"}),b())};return r?(0,s.jsx)("div",{className:"p-8 text-center flex items-center justify-center h-full",children:(0,s.jsx)(c.Z,{})}):(0,s.jsxs)("div",{className:"p-6 md:p-8 dark:bg-gray-900/50 min-h-full",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"WhatsApp Groups"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage and communicate with your registered WhatsApp groups."})]}),(0,s.jsxs)("button",{onClick:()=>k(),className:"bg-blue-600 text-white px-4 py-2 rounded-md flex items-center shadow-sm hover:bg-blue-700",children:[(0,s.jsx)(i.Z,{size:16,className:"mr-2"})," Register Group"]})]}),0===e.length?(0,s.jsxs)("div",{className:"text-center py-20 border-2 border-dashed rounded-lg",children:[(0,s.jsx)(l.Z,{size:48,className:"mx-auto text-gray-400"}),(0,s.jsx)("h3",{className:"mt-2 text-lg font-medium text-gray-800 dark:text-gray-200",children:"No Groups Registered"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Click 'Register Group' to start managing a WhatsApp group."})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:e.name}),(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)("button",{onClick:()=>k(e),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,s.jsx)(n.Z,{size:16})}),(0,s.jsx)("button",{onClick:()=>j(e.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,s.jsx)(o.Z,{size:16})})]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono mt-1 break-all",children:e.whatsappGroupId}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:["Last message: ",e.lastMessageAt?(0,g.Q)(new Date(e.lastMessageAt),{addSuffix:!0}):"Never"]})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(p.default,{href:"/groups/".concat(e.id),className:"w-full bg-green-500 text-white px-4 py-2 rounded-md flex items-center justify-center text-sm font-semibold hover:bg-green-600",children:[(0,s.jsx)(d,{size:16,className:"mr-2"})," Open Chat"]})})]},e.id))}),x&&(0,s.jsx)(h,{group:y,isOpen:x,onClose:()=>{m(!1),f(null)},onSuccess:()=>{m(!1),f(null),b()}})]})}},3258:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=()=>(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-8",role:"status","aria-label":"Loading",children:[(0,s.jsxs)("svg",{width:"80",height:"80",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",className:"text-blue-600",children:[(0,s.jsxs)("g",{style:{animation:"vc-pulse-bubble 2.5s infinite ease-in-out",transformOrigin:"center"},children:[(0,s.jsx)("path",{d:"M85,50 A35,35 0 1,1 15,50 A35,35 0 0,1 85,50 Z",fill:"currentColor",fillOpacity:"0.1"}),(0,s.jsx)("path",{d:"M20,70 Q30,85 40,70 L20,70 Z",fill:"currentColor",fillOpacity:"0.1"})]}),(0,s.jsx)("path",{style:{strokeDasharray:90,strokeDashoffset:90,animation:"vc-draw-v 1.5s ease-out forwards infinite"},d:"M30 35 L 50 58 L 70 35",stroke:"currentColor",strokeWidth:"5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),(0,s.jsxs)("g",{className:"text-gray-400",fill:"currentColor",children:[(0,s.jsx)("circle",{style:{animation:"vc-blink-ellipsis 1.4s infinite 0s"},cx:"38",cy:"72",r:"3"}),(0,s.jsx)("circle",{style:{animation:"vc-blink-ellipsis 1.4s infinite 0.2s"},cx:"50",cy:"72",r:"3"}),(0,s.jsx)("circle",{style:{animation:"vc-blink-ellipsis 1.4s infinite 0.4s"},cx:"62",cy:"72",r:"3"})]})]}),(0,s.jsx)("p",{className:"text-gray-500 mt-2 text-sm font-medium animate-pulse",children:"Connecting..."})]})},5260:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=e=>{let{isOpen:t,onClose:r,title:a,children:i}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",onClick:r,children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md m-4",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:a}),(0,s.jsx)("button",{onClick:r,className:"text-gray-500 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100",children:"\xd7"})]}),(0,s.jsx)("div",{className:"p-4",children:i})]})}):null}}},function(e){e.O(0,[138,792,563,971,23,744],function(){return e(e.s=720)}),_N_E=e.O()}]);